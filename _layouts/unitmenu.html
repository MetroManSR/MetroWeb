<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dynamic Unit Menu</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    nav ul {
      list-style-type: none;
      padding: 10px;
      background-color: #f8f8f8;
      border-bottom: 1px solid #ddd;
    }
    nav ul li {
      display: inline;
      margin-right: 10px;
    }
    main {
      padding: 20px;
      margin-top: 20px; /* Adjusting margin to prevent clipping */
    }
  </style>
  <!-- Load the marked library -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Ensure marked is defined
      if (typeof marked === 'undefined') {
        console.error('Marked library is not loaded properly.');
        return;
      } else {
        console.log('Marked library loaded successfully.');
      }

      function loadPage(unit, lesson) {
        fetch(`/balkeon/letslearn/${unit}/${lesson}.md`)
          .then(response => response.text())
          .then(data => {
            document.getElementById('content').innerHTML = marked.parse(data);
          })
          .catch(error => console.error('Error loading page:', error));
      }

      function loadUnitMenu(unit) {
        fetch(`/balkeon/letslearn/${unit}/unitmenu.md`)
          .then(response => response.text())
          .then(data => {
            const content = marked.parse(data);
            document.getElementById('content').innerHTML = content;
            addLessonLinks(unit); // Adding links dynamically
          })
          .catch(error => console.error('Error loading unit menu:', error));
      }

      function addLessonLinks(unit) {
        const lessons = document.querySelectorAll('#content a[data-lesson]');
        lessons.forEach(lesson => {
          lesson.addEventListener('click', function(event) {
            event.preventDefault();
            const lessonId = this.getAttribute('data-lesson');
            loadPage(unit, lessonId);
          });
        });
      }

      // Initialize with unit01 menu
      loadUnitMenu('unit01');

      // Add event listeners for nav links
      document.querySelectorAll('nav ul li a').forEach(link => {
        link.addEventListener('click', function(event) {
          event.preventDefault();
          const unit = this.textContent.trim().toLowerCase().replace(' ', '');
          loadUnitMenu(unit);
        });
      });
    });
  </script>
</head>
<body>
  <nav>
    <ul>
      <li><a href="#">Unit 01</a></li>
      <li><a href="#">Unit 02</a></li>
      <li><a href="#">Unit XX</a></li>
    </ul>
  </nav>
  <main id="content">
    <!-- Content will be loaded here -->
  </main>
</body>
</html>
